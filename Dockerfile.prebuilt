FROM alpine:3.19

# Install CA certificates for HTTPS
RUN apk add --no-cache ca-certificates tzdata

# Copy pre-built binary
COPY goqueue-amd64 /usr/local/bin/goqueue

# Set permissions
RUN chmod +x /usr/local/bin/goqueue

# Create data directory
RUN mkdir -p /data && chown 1000:1000 /data

# Expose ports
EXPOSE 8080 9000 7000

# Set working directory
WORKDIR /data

# Run as non-root user
USER 1000

ENTRYPOINT ["/usr/local/bin/goqueue"]
CMD ["--config", "/config/config.yaml"]
